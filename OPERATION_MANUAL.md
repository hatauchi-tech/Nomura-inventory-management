# 在庫管理システム 運用手順書

## 目次

1. [日常業務](#1-日常業務)
2. [入出庫業務](#2-入出庫業務)
3. [棚卸業務](#3-棚卸業務)
4. [在庫確認](#4-在庫確認)
5. [管理者業務](#5-管理者業務)
6. [トラブル対応](#6-トラブル対応)

---

## 1. 日常業務

### 1.1 システムへのログイン

1. Webブラウザで配布されたURLにアクセス
2. Googleアカウントでログイン（組織アカウント推奨）
3. 権限に応じたホーム画面が表示される
   - **管理者**: 全機能が利用可能
   - **現場担当**: 出庫登録、棚卸入力、在庫確認が利用可能

### 1.2 推奨ブラウザ

- Google Chrome（最新版）
- Microsoft Edge（最新版）
- Safari（最新版）

---

## 2. 入出庫業務

### 2.1 出庫登録（全ユーザー）

**作業タイミング**: 製品を出荷・持ち出しする際

1. ホーム画面から「入出庫登録」を選択
2. 「出庫」を選択
3. 以下の情報を入力:
   - **保管場所**: 製品を取り出す場所
   - **カテゴリ1**: 製品の大分類
   - **カテゴリ2**: 製品の小分類
   - **製品**: 出庫する製品
   - **数量**: 出庫数（現在庫数を超えない）
   - **現場名**: 出荷先の現場名
   - **客先**: 顧客名
4. 「登録」ボタンをクリック
5. 確認メッセージが表示されたら完了

**注意事項**:
- 在庫数を超える出庫はエラーになります
- 現場名・客先は後から履歴画面で編集可能です

### 2.2 入庫登録（管理者のみ）

**作業タイミング**: 製品を仕入れ・入荷した際

1. ホーム画面から「入出庫登録」を選択
2. 「入庫」を選択
3. 以下の情報を入力:
   - **保管場所**: 製品を保管する場所
   - **カテゴリ1/カテゴリ2/製品**: 入庫する製品を選択
   - **数量**: 入庫数
4. 「登録」ボタンをクリック

### 2.3 入出庫履歴の確認・修正

**作業タイミング**: 登録内容の確認や修正が必要な際

1. ホーム画面から「入出庫履歴確認」を選択
2. 絞り込み条件を設定:
   - 入出庫タイプ（入庫/出庫/全て）
   - 保管場所
   - カテゴリ
   - 期間（開始日〜終了日）
   - 現場名・客先（部分一致検索）
3. 「履歴を表示」をクリック

#### 履歴の編集

1. 対象の履歴行で「編集」ボタンをクリック
2. 数量・現場名・客先を修正
3. 「保存」をクリック
4. 在庫数が自動的に再計算される

#### 履歴の削除

1. 対象の履歴行で「削除」ボタンをクリック
2. 確認ダイアログで「OK」をクリック
3. 在庫数が自動的に元に戻る

#### 製品の変更

**ユースケース**: 誤った製品で登録してしまった場合

1. 対象の履歴行で「製品変更」ボタンをクリック
2. カテゴリを選択して製品を検索
3. 正しい製品を選択
4. 「変更を実行」をクリック
5. 旧製品の在庫が戻り、新製品の在庫が更新される

**注意事項**:
- 出庫記録の製品変更時、新製品の在庫が不足している場合はエラー
- 管理者は全員の履歴を編集可能、一般ユーザーは自分の履歴のみ

---

## 3. 棚卸業務

### 3.1 棚卸の流れ

```
[イベント作成] → [カウント入力] → [照合] → [確定]
  (管理者)       (全ユーザー)    (管理者)   (管理者)
```

### 3.2 棚卸カウント入力（全ユーザー）

**作業タイミング**: 棚卸イベントが開始されたら

1. ホーム画面から「棚卸カウント入力」を選択
2. 対象の棚卸イベントを選択
3. 保管場所を選択
4. 製品ごとにカウント数を入力

#### 入力形式

| 入力例 | 説明 | 結果 |
|--------|------|------|
| `48` | 単純な数値 | 48 |
| `48×18` | 入り数×梱包数 | 864 |
| `48*18` | 半角アスタリスク | 864 |
| `48x18` | 小文字x | 864 |
| `-5` | マイナス値 | -5（調整用） |

**計算式入力の活用例**:
- 段ボール18箱、1箱48個入りの場合: `48×18` と入力 → 自動計算で864

5. 同じ製品を複数回入力すると合計される
6. 「一括登録」ボタンで複数製品を同時に登録

**注意事項**:
- 合計がマイナスになる場合は登録不可
- 「自分の入力履歴」で入力済み内容を確認可能

### 3.3 棚卸照合・確定（管理者のみ）

**作業タイミング**: 全担当者のカウント入力完了後

1. ホーム画面から「棚卸照合・確定」を選択
2. 対象の棚卸イベントを選択
3. 「照合実行」をクリック
4. 不一致がある場合は担当者別のカウント数を確認
5. 「明細表示」で各製品の詳細を確認・修正
6. 確定実在庫数と差異理由を入力
7. 「棚卸を確定する」をクリック
8. 在庫数が確定値に更新される

---

## 4. 在庫確認

### 4.1 在庫一覧・検索

1. ホーム画面から「在庫一覧・検索」を選択
2. 検索条件を入力（カテゴリ、製品名）
3. 表示形式を選択:
   - **全在庫表示**: 製品×保管場所ごとの在庫
   - **製品別集計**: 製品ごとの合計在庫
   - **保管場所別集計**: 場所ごとの在庫一覧

---

## 5. 管理者業務

### 5.1 マスタ管理

#### 製品マスタ

1. 「マスタ管理」→「製品」タブ
2. 新規登録: 製品名、カテゴリ1、カテゴリ2、単価を入力
3. 編集: 対象行の「編集」ボタン
4. 削除: 対象行の「削除」ボタン（論理削除）

#### ユーザーマスタ

1. 「マスタ管理」→「ユーザー」タブ
2. 新規登録: 部門、ユーザー名、メールアドレス、権限を入力
3. 権限:
   - **管理者**: 全機能利用可能
   - **現場担当**: 出庫、棚卸入力、在庫確認のみ

#### 保管場所マスタ

1. 「マスタ管理」→「保管場所」タブ
2. 新規登録: 場所名を入力
3. 削除: 在庫がある場所は削除不可

### 5.2 棚卸イベント作成

1. 「棚卸照合・確定」画面へ
2. イベント名を入力（例: 2025年11月棚卸）
3. 「イベント作成」をクリック
4. 現在の在庫状況がスナップショットとして保存される

---

## 6. トラブル対応

### 6.1 よくある問題と対処法

| 問題 | 原因 | 対処法 |
|------|------|--------|
| ログインできない | ユーザー未登録 | 管理者にメールアドレス登録を依頼 |
| 出庫できない | 在庫不足 | 在庫数を確認、必要に応じて入庫登録 |
| 画面が真っ白 | ブラウザキャッシュ | Ctrl+F5で強制リロード |
| 計算式が認識されない | 全角スペース混入 | 入力値を再確認、半角で入力 |
| 製品変更でエラー | 新製品の在庫不足 | 先に新製品を入庫するか、数量を調整 |

### 6.2 緊急時の連絡先

システム管理者に連絡してください。

### 6.3 データバックアップ

- スプレッドシートは自動保存されます
- 定期的にスプレッドシートのコピーを作成することを推奨

---

## 改訂履歴

| バージョン | 日付 | 内容 |
|-----------|------|------|
| 1.0.0 | 2025年11月 | 初版作成 |

---

**作成日**: 2025年11月
**作成者**: システム管理者
